<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Petr Kozelka" />
    <meta name="Date-Revision-yyyymmdd" content="20140904" />
    <meta http-equiv="Content-Language" content="en" />
    <title>args-inject - MyPathTool Sample</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

                          
        
<link rel="stylesheet" type="text/css" href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" media="all"/>
                      
        
<link rel="stylesheet" type="text/css" href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css" media="all"/>
                      
        
<style>#bodyColumn { max-width: 840px }
        .syntaxhighlighter {
        border: 1px dotted silver;
        padding: 12px;
        }</style>
                      
        
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js" language="javaScript"></script>
                      
        
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJava.js" language="javaScript"></script>
                      
        
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js" language="javaScript"></script>
                      
        
<script language="javascript">SyntaxHighlighter.defaults['light'] = true;
        SyntaxHighlighter.all();</script>
          
                  </head>
        <body class="topBarEnabled">
          
                        
                    
                

    <div id="topbar" class="navbar navbar-fixed-top navbar-inverse">
      <div class="navbar-inner">
                                  <div class="container"><div class="nav-collapse">
            
                
                                            <a class="brand" href="http://code.kozelka.net/index.html"  title="code.kozelka.net">

                                
                                    code
                
                </a>
                    
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">args-inject <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="index.html"  title="Introduction">Introduction</a>
</li>
                  
                      <li>      <a href="Features.html"  title="Features">Features</a>
</li>
                  
                      <li>      <a href="Comparison.html"  title="Comparison">Comparison</a>
</li>
                  
                      <li>      <a href="Tutorial.html"  title="Tutorial">Tutorial</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li class="dropdown-submenu">
                                      <a href="Design.html"  title="Model">Model</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="Subcommands.html"  title="Subcommands">Subcommands</a>
</li>
                                  <li>      <a href="Options.html"  title="Options">Options</a>
</li>
                                  <li>      <a href="Params.html"  title="Params">Params</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="Samples.html"  title="Samples">Samples</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="MiniCalc.html"  title="MiniCalc">MiniCalc</a>
</li>
                                  <li>      <a href="MyPathTool.html"  title="MyPathTool">MyPathTool</a>
</li>
                                  <li>      <a href="Timmy.html"  title="Timmy">Timmy</a>
</li>
                              </ul>
            </li>
                  
                      <li>      <a href="CliTypes.html"  title="CLI types">CLI types</a>
</li>
                  
                      <li>      <a href="Varargs.html"  title="Varargs">Varargs</a>
</li>
                  
                      <li>      <a href="HelpCommand.html"  title="Embedded help">Embedded help</a>
</li>
                  
                      <li>      <a href="MainEntryPoint.html"  title="Writing main() method">Writing main() method</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hacking <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="Design.html"  title="Design">Design</a>
</li>
                  
                      <li>      <a href="CustomParser.html"  title="Writing custom parser">Writing custom parser</a>
</li>
                  
                      <li>      <a href="CustomAnalyzer.html"  title="Writing declaration analyzer">Writing declaration analyzer</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li class="dropdown-submenu">
                                      <a href="project-info.html"  title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="dependencies.html"  title="Dependencies">Dependencies</a>
</li>
                                  <li>      <a href="team-list.html"  title="Project Team">Project Team</a>
</li>
                                  <li>      <a href="plugins.html"  title="Project Plugins">Project Plugins</a>
</li>
                                  <li>      <a href="issue-tracking.html"  title="Issue Tracking">Issue Tracking</a>
</li>
                                  <li>      <a href="license.html"  title="Project License">Project License</a>
</li>
                                  <li>      <a href="source-repository.html"  title="Source Repository">Source Repository</a>
</li>
                                  <li>      <a href="project-summary.html"  title="Project Summary">Project Summary</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="project-reports.html"  title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="surefire-report.html"  title="Surefire Report">Surefire Report</a>
</li>
                                  <li>      <a href="cobertura/index.html"  title="Cobertura Test Coverage">Cobertura Test Coverage</a>
</li>
                                  <li>      <a href="findbugs.html"  title="FindBugs Report">FindBugs Report</a>
</li>
                                  <li>      <a href="pmd.html"  title="PMD">PMD</a>
</li>
                                  <li>      <a href="cpd.html"  title="CPD">CPD</a>
</li>
                                  <li>      <a href="xref/index.html"  title="Source Xref">Source Xref</a>
</li>
                                  <li>      <a href="xref-test/index.html"  title="Test Source Xref">Test Source Xref</a>
</li>
                                  <li>      <a href="apidocs/index.html"  title="JavaDocs">JavaDocs</a>
</li>
                                  <li>      <a href="testapidocs/index.html"  title="Test JavaDocs">Test JavaDocs</a>
</li>
                                  <li>      <a href="changes-report.html"  title="Changes Report">Changes Report</a>
</li>
                              </ul>
            </li>
                          </ul>
      </li>
                  </ul>
          
          
                                              
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

        <ul class="nav pull-right"><li style="margin-top: 10px;">
    
    <div class="g-plusone" data-href="http://code.kozelka.net/args-inject" data-size="medium"  width="60px" align="right" ></div>

        </li></ul>
                                            
                               <ul class="nav pull-right">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Links <b class="caret"></b></a>
                <ul class="dropdown-menu">
                      <li>      <a href="https://github.com/pkozelka/args-inject"  title="Fork me on GitHub">Fork me on GitHub</a>
</li>
      <li>      <a href="http://www.apache.org/"  title="Apache">Apache</a>
</li>
      <li>      <a href="http://maven.apache.org/"  title="Maven 2">Maven 2</a>
</li>
                  </ul>
              </li>
            </ul>
          
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2></h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="index.html" title="args-inject">
        args-inject</a>
                    <span class="divider">»</span>
      </li>
        <li class="active ">MyPathTool Sample</li>
        
                
                    
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2014-09-04</li>
              <li id="projectVersion" class="pull-right">
                    Version: 1-SNAPSHOT
        </li>
            
                            </ul>
      </div>

      
                        
        <div id="bodyColumn" >
                                  
            <div class="section">
<h2>MyPathTool Sample (mpt)<a name="MyPathTool_Sample_mpt"></a></h2>
<p>Implements a commandline application doing some useful stuff with path lists.</p>
<p>Demonstrates:</p>
<ul>
<li>application without subcommands (all functionality implemented by one, unnamed, subcommand)</li>
<li>mapping pathlist to <tt>File[]</tt> array - separated by colon or semicolon depending on operating system</li>
<li>mapping comma separated exclussion list to <tt>String[]</tt> array</li>
<li>using paramless option method</li>
<li>using option method with boolean value</li></ul>
<div class="section">
<h3>MyPathTool.java<a name="MyPathTool.java"></a></h3><pre class="brush: java">package net.kozelka.args.mypathtool;

import java.io.File;
import java.io.IOException;
import java.util.*;
import net.kozelka.args.BasicArgsParser;
import net.kozelka.args.DefaultHelpCommand;
import net.kozelka.args.annotation.AnnottationAwareSetup;
import net.kozelka.args.annotation.Option;
import net.kozelka.args.annotation.Param;
import net.kozelka.args.api.ArgsCommand;

/**
 * Commandline archetype: no subcommands, just single param and some options
 * This sample code demonstrates working with array input arguments.
 */
public class MyPathTool implements ArgsCommand {
    private final File[] pathList;
    private boolean dirPerLine;
    private boolean keepDuplicatePaths;
    private boolean keepMissingPaths;
    private Set&lt;String&gt; exclude = Collections.emptySet();

    public MyPathTool(@Param(&quot;path&quot;) File[] pathList) {
        this.pathList = pathList;
    }

    @Option(shortName = &quot;-l&quot;, longName = &quot;--multi-line-output&quot;, description = &quot;list paths one per line&quot;)
    public void dirPerLine() {
        dirPerLine = true;
    }

    @Option(shortName = &quot;-kd&quot;, longName = &quot;--keep-duplicate-paths&quot;, description = &quot;do not remove duplicates&quot;)
    public void setKeepDuplicatePaths(boolean keepDuplicatePaths) {
        this.keepDuplicatePaths = keepDuplicatePaths;
    }

    @Option(shortName = &quot;-km&quot;, longName = &quot;--keep-missing-paths&quot;, description = &quot;do not remove missing paths&quot;)
    public void setKeepMissingPaths(boolean keepMissingPaths) {
        this.keepMissingPaths = keepMissingPaths;
    }

    @Option(longName = &quot;--exclude&quot;, description=&quot;excludes directories containing given subpaths (comma separated)&quot;)
    public void setExclude(String... exclude) {
        this.exclude = new HashSet&lt;String&gt;(Arrays.asList(exclude));
    }

    public Integer call() throws Exception {
        final Collection&lt;File&gt; result = keepDuplicatePaths ? new ArrayList&lt;File&gt;() :  new LinkedHashSet&lt;File&gt;();
        for (File path : pathList) {
            try {
                if (! keepMissingPaths) {
                    if (!path.exists()) {
                        System.err.println(&quot;missing path: &quot; + path);
                        continue;
                    }
                }
                if (containsExcludedSubpath(path)) {
                    System.err.println(&quot;excluding: &quot; + path);
                    continue;
                }
                final File d = path.getCanonicalFile();
                if (!result.add(d)) {
                    System.err.println(&quot;duplicate path: &quot; + d);
                }
            } catch (IOException e) {
                System.err.println(&quot;invalid path: &quot; + path);
            }
        }
        printPathList(result);
        return 0;
    }

    private boolean containsExcludedSubpath(File path) {
        for (String ex : exclude) {
            final File p = new File(path, ex);
            if (p.exists()) return true;
        }
        return false;
    }

    private void printPathList(Collection&lt;File&gt; paths) {
        if (dirPerLine) {
            for (File path : paths) {
                System.out.println(path);
            }
        } else {
            final StringBuilder sb = new StringBuilder();
            for (File path : paths) {
                if (sb.length() != 0) {
                    sb.append(File.pathSeparatorChar);
                }
                sb.append(path);
            }
            System.out.println(sb);
        }
    }

    /**
     * Highest-possible level of invocation usable both from {@link #main} and from unit tests.
     *
     * @param args commandline arguments
     * @return true if successful
     * @throws Exception -
     */
    static int run(String... args) throws Exception {
        final AnnottationAwareSetup setup = new AnnottationAwareSetup(&quot;mpt&quot;);
        setup.setDefaultSubCommand(MyPathTool.class);
        setup.addSubCommand(DefaultHelpCommand.class);
        return BasicArgsParser.process(setup, args);
    }

    public static void main(String[] args) throws Exception {
        final int exitCode = run(args);
        if (exitCode != 0) {
            System.exit(exitCode);
        }
    }
}
</pre></div></div>
                  </div>
          </div>

    <hr/>

    <footer>
            <div class="container">
                      <div class="row">
                              <p >Copyright &copy;                    2014
                        <a href="http://kozelka.net">Petr Kozelka</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
                <p id="poweredBy" class="pull-right">
                          <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
              </p>
        
                </div>
    </footer>
        </body>
</html>
