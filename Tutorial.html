<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Petr Kozelka" />
    <meta name="Date-Revision-yyyymmdd" content="20140904" />
    <meta http-equiv="Content-Language" content="en" />
    <title>args-inject - Tutorial</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

                          
        
<link rel="stylesheet" type="text/css" href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" media="all"/>
                      
        
<link rel="stylesheet" type="text/css" href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeDefault.css" media="all"/>
                      
        
<style>#bodyColumn { max-width: 840px }
        .syntaxhighlighter {
        border: 1px dotted silver;
        padding: 12px;
        }</style>
                      
        
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js" language="javaScript"></script>
                      
        
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushJava.js" language="javaScript"></script>
                      
        
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js" language="javaScript"></script>
                      
        
<script language="javascript">SyntaxHighlighter.defaults['light'] = true;
        SyntaxHighlighter.all();</script>
          
                  </head>
        <body class="topBarEnabled">
          
                        
                    
                

    <div id="topbar" class="navbar navbar-fixed-top navbar-inverse">
      <div class="navbar-inner">
                                  <div class="container"><div class="nav-collapse">
            
                
                                            <a class="brand" href="http://code.kozelka.net/index.html"  title="code.kozelka.net">

                                
                                    code
                
                </a>
                    
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">args-inject <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="index.html"  title="Introduction">Introduction</a>
</li>
                  
                      <li>      <a href="Features.html"  title="Features">Features</a>
</li>
                  
                      <li>      <a href="Comparison.html"  title="Comparison">Comparison</a>
</li>
                  
                      <li>      <a href="Tutorial.html"  title="Tutorial">Tutorial</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li class="dropdown-submenu">
                                      <a href="Design.html"  title="Model">Model</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="Subcommands.html"  title="Subcommands">Subcommands</a>
</li>
                                  <li>      <a href="Options.html"  title="Options">Options</a>
</li>
                                  <li>      <a href="Params.html"  title="Params">Params</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="Samples.html"  title="Samples">Samples</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="MiniCalc.html"  title="MiniCalc">MiniCalc</a>
</li>
                                  <li>      <a href="MyPathTool.html"  title="MyPathTool">MyPathTool</a>
</li>
                                  <li>      <a href="Timmy.html"  title="Timmy">Timmy</a>
</li>
                              </ul>
            </li>
                  
                      <li>      <a href="CliTypes.html"  title="CLI types">CLI types</a>
</li>
                  
                      <li>      <a href="Varargs.html"  title="Varargs">Varargs</a>
</li>
                  
                      <li>      <a href="HelpCommand.html"  title="Embedded help">Embedded help</a>
</li>
                  
                      <li>      <a href="MainEntryPoint.html"  title="Writing main() method">Writing main() method</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hacking <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="Design.html"  title="Design">Design</a>
</li>
                  
                      <li>      <a href="CustomParser.html"  title="Writing custom parser">Writing custom parser</a>
</li>
                  
                      <li>      <a href="CustomAnalyzer.html"  title="Writing declaration analyzer">Writing declaration analyzer</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li class="dropdown-submenu">
                                      <a href="project-info.html"  title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="dependencies.html"  title="Dependencies">Dependencies</a>
</li>
                                  <li>      <a href="team-list.html"  title="Project Team">Project Team</a>
</li>
                                  <li>      <a href="plugins.html"  title="Project Plugins">Project Plugins</a>
</li>
                                  <li>      <a href="issue-tracking.html"  title="Issue Tracking">Issue Tracking</a>
</li>
                                  <li>      <a href="license.html"  title="Project License">Project License</a>
</li>
                                  <li>      <a href="source-repository.html"  title="Source Repository">Source Repository</a>
</li>
                                  <li>      <a href="project-summary.html"  title="Project Summary">Project Summary</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="project-reports.html"  title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="surefire-report.html"  title="Surefire Report">Surefire Report</a>
</li>
                                  <li>      <a href="cobertura/index.html"  title="Cobertura Test Coverage">Cobertura Test Coverage</a>
</li>
                                  <li>      <a href="findbugs.html"  title="FindBugs Report">FindBugs Report</a>
</li>
                                  <li>      <a href="pmd.html"  title="PMD">PMD</a>
</li>
                                  <li>      <a href="cpd.html"  title="CPD">CPD</a>
</li>
                                  <li>      <a href="xref/index.html"  title="Source Xref">Source Xref</a>
</li>
                                  <li>      <a href="xref-test/index.html"  title="Test Source Xref">Test Source Xref</a>
</li>
                                  <li>      <a href="apidocs/index.html"  title="JavaDocs">JavaDocs</a>
</li>
                                  <li>      <a href="testapidocs/index.html"  title="Test JavaDocs">Test JavaDocs</a>
</li>
                                  <li>      <a href="changes-report.html"  title="Changes Report">Changes Report</a>
</li>
                              </ul>
            </li>
                          </ul>
      </li>
                  </ul>
          
          
                                              
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

        <ul class="nav pull-right"><li style="margin-top: 10px;">
    
    <div class="g-plusone" data-href="http://code.kozelka.net/args-inject" data-size="medium"  width="60px" align="right" ></div>

        </li></ul>
                                            
                               <ul class="nav pull-right">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">External Links <b class="caret"></b></a>
                <ul class="dropdown-menu">
                      <li>      <a href="https://github.com/pkozelka/args-inject"  title="Fork me on GitHub">Fork me on GitHub</a>
</li>
      <li>      <a href="http://www.apache.org/"  title="Apache">Apache</a>
</li>
      <li>      <a href="http://maven.apache.org/"  title="Maven 2">Maven 2</a>
</li>
                  </ul>
              </li>
            </ul>
          
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2></h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="index.html" title="args-inject">
        args-inject</a>
                    <span class="divider">»</span>
      </li>
        <li class="active ">Tutorial</li>
        
                
                    
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2014-09-04</li>
              <li id="projectVersion" class="pull-right">
                    Version: 1-SNAPSHOT
        </li>
            
                            </ul>
      </div>

      
                        
        <div id="bodyColumn" >
                                  
            <ul>
<li><a href="#Creating_a_simple_commandline_application">Creating a simple commandline application</a>
<ul>
<li><a href="#Adding_args-inject_to_dependencies">Adding args-inject to dependencies</a>
<ul>
<li><a href="#Maven2_project">Maven2 project</a></li>
<li><a href="#Ant_project">Ant project</a></li>
<li><a href="#Direct_download_link">Direct download link</a></li>
<li><a href="#Any_other_build_system_or_IDE">Any other build system or IDE</a></li></ul></li>
<li><a href="#Creating_SubCommand_class">Creating SubCommand class</a>
<ul>
<li><a href="#Sample_subcommand_class">Sample subcommand class</a></li></ul></li>
<li><a href="#Defining_option_method">Defining option method</a></li>
<li><a href="#Creating_application_class">Creating application class</a>
<ul>
<li><a href="#Sample_main_method">Sample main method</a></li></ul></li>
<li><a href="#Creating_wrapper_shell_script">Creating wrapper shell script</a></li></ul></li>
<li><a href="#Finetuning">Finetuning</a></li></ul>
<div class="section">
<h2>Args-inject step-by-step tutorial<a name="Args-inject_step-by-step_tutorial"></a></h2>
<p>This tutorial assumes you will read also some other pages on the site, and concentrates on stating rules and recommendations in each step.</p>
<div class="section">
<h3>Creating a simple commandline application<a name="Creating_a_simple_commandline_application"></a></h3>
<p>Basic steps</p>
<ul>
<li>Add <tt>args-inject</tt> to your compile dependencies <i>(== javac classpath)</i></li>
<li>Create SubCommand class</li>
<li>Define options methods</li>
<li>Create Application class</li>
<li>Creating wrapper shell script</li></ul>
<div class="section">
<h4>Adding args-inject to dependencies<a name="Adding_args-inject_to_dependencies"></a></h4>
<div class="section">
<h5>Maven2 project<a name="Maven2_project"></a></h5>
<p>If you use Maven2, you have a project with a <tt>pom.xml</tt> so you will need to add something like this <i>(with the released version that you selected, of course)</i>:</p><pre class="brush: xml">  &lt;dependency&gt;
    &lt;groupId&gt;net.kozelka&lt;/groupId&gt;
    &lt;artifactId&gt;args-inject&lt;/artifactId&gt;
    &lt;version&gt;0.1-SNAPSHOT&lt;/version&gt;
  &lt;/dependency&gt;
</pre></div>
<div class="section">
<h5>Ant project<a name="Ant_project"></a></h5>
<p>If you compile your code with Ant, then fragments of following code might be useful to you:</p><pre class="brush: xml">  &lt;project name=&quot;my-project&quot;
      xmlns=&quot;antlib:org.apache.tools.ant&quot;
      xmlns:artifact=&quot;urn:maven-artifact-ant&quot;&gt;
    &lt;!-- add maven-ant-tasks --&gt;
    &lt;typedef classpath=&quot;${user.home}/.m2/lib/maven-ant-tasks-2.2.1.jar&quot;
        resource=&quot;org/apache/maven/artifact/ant/antlib.xml&quot;
        uri=&quot;urn:maven-artifact-ant&quot;/&gt;
    &lt;!-- resolve the dependency --&gt;
    &lt;artifact:dependencies&gt;
      &lt;artifact:dependency groupId=&quot;net.kozelka&quot; artifactId=&quot;args-inject&quot; version=&quot;0.1-SNAPSHOT&quot;/&gt;
    &lt;/artifact:dependencies&gt;
    &lt;!-- use the dependency as a file --&gt;
    &lt;echo&gt;add this path to javac classpath: ${net.kozelka:args-inject:jar}&lt;/echo&gt;
    &lt;!-- ... --&gt;
</pre>
<p>Note that this uses the ant library <a class="externalLink" href="http://maven.apache.org/ant-tasks/">maven-ant-tasks</a> which is an excellent library for reusing Maven artifacts in Ant code; I highly recommend it to your attention.</p></div>
<div class="section">
<h5>Direct download link<a name="Direct_download_link"></a></h5>
<p>In some cases, it might still be useful to have direct download links. Here they are:</p>
<table border="0" class="table table-striped">
<tr class="a">
<td align="left"><b>Artifact</b></td>
<td align="center"><b>MD5</b></td>
<td align="center"><b>SHA1</b></td>
<td align="left"><b>Description</b></td></tr>
<tr class="b">
<td align="left"><a class="externalLink" href="http://repo1.maven.org/maven2/net/kozelka/args-inject/0.1-SNAPSHOT/0.1-SNAPSHOT.jar">args-inject-0.1-SNAPSHOT.jar</a></td>
<td align="center"><a href="#jar.md5">MD5</a></td>
<td align="center"><a class="externalLink" href="http://jar.sha1">SHA1</a></td>
<td align="left">library JAR</td></tr>
<tr class="a">
<td align="left"><a class="externalLink" href="http://sources.jar">args-inject-0.1-SNAPSHOT-sources.jar</a></td>
<td align="center"><a href="#sources.jar.md5">MD5</a></td>
<td align="center"><a href="#sources.jar.sha1">SHA1</a></td>
<td align="left">library sources</td></tr></table></div>
<div class="section">
<h5>Any other build system or IDE<a name="Any_other_build_system_or_IDE"></a></h5>
<p>Well, reading the above sections, you get the idea - use your skills to setup your buildsystem so that it compiles against <tt>args-inject</tt>, among other external libraries.</p></div></div>
<div class="section">
<h4>Creating SubCommand class<a name="Creating_SubCommand_class"></a></h4>
<p>Rules</p>
<ul>
<li>the class must implement <tt>ArgsCommand</tt></li>
<li>class should be annottated with <tt>@SubCommand</tt> with a little description</li>
<li>create constructor with taking mandatory parameters of the command</li>
<li>to allow unlimited number of params, your last constructor's parameter can be Java varargs array <i>(using notation &quot;SomeType... myarray&quot; )</i></li>
<li>the functionality must be implemented within the <tt>Integer call()</tt> method; usually you will want to return 0 from it</li></ul>
<p>Hints</p>
<ul>
<li>create a common ancestor for your subcommand classes, to share functionality and option declarations</li>
<li>to share only option declarations between commands, use dedicated interface</li>
<li>unnamed subcommand class can only be used for default subcommand</li>
<li>returning any other <i>exitCode</i> from <tt>call()</tt> makes only sense if you want your application to fail silently - or if your code already printed an error message</li></ul>
<div class="section">
<h5>Sample subcommand class<a name="Sample_subcommand_class"></a></h5><pre class="brush: java">package net.kozelka.args;

import java.io.File;
import java.util.Arrays;
import java.util.Properties;
import java.util.concurrent.TimeUnit;
import net.kozelka.args.annotation.AnnottationAwareSetup;
import net.kozelka.args.annotation.Option;
import net.kozelka.args.annotation.SubCommand;
import net.kozelka.args.api.ArgsCommand;

@SubCommand(name = &quot;ls&quot;, description = &quot;list files (demo)&quot;)
public class DemoFileLister implements ArgsCommand {
    private final boolean deep;
    private final int maxCount;
    final File[] files;
    private boolean colorful;
    private final Properties properties = new Properties();
    private TimeUnit timeunit = TimeUnit.NANOSECONDS;
    private File[] locations;
    private int[] numbers;

    public DemoFileLister(boolean deep, int maxCount, File... files) {
        this.deep = deep;
        this.maxCount = maxCount;
        this.files = files;
    }

    @Option(longName = &quot;--locations&quot;, description = &quot;shows that default separator for files is File.pathSeparator&quot;)
    public void setLocations(File[] locations) {
        this.locations = locations;
    }

    @Option(longName = &quot;--numbers&quot;, description = &quot;shows that default separator is comma&quot;)
    public void setNumbers(int[] numbers) {
        this.numbers = numbers;
    }

    @Option(longName = &quot;--time-unit&quot;, shortName = &quot;-u&quot;)
    public void setTimeunit(TimeUnit timeunit) {
        this.timeunit = timeunit;
    }

    @Option(longName = &quot;--property&quot;, shortName = &quot;-D&quot;)
    public void addProperty(String propertyName, String propertyValue) {
        properties.put(propertyName, propertyValue);
    }

    @Option(longName = &quot;--color&quot;, shortName = &quot;-C&quot;, description = &quot;set output colors&quot;)
    public void setColorful(boolean colorful) {
        this.colorful = colorful;
    }

    public Integer call() throws Exception {
        System.out.println(&quot;colorful = &quot; + colorful);
        System.out.println(&quot;deep = &quot; + deep);
        System.out.println(&quot;maxCount = &quot; + maxCount);
        System.out.println(&quot;files = &quot; + Arrays.asList(files));
        System.out.println(&quot;properties = &quot; + properties);
        System.out.println(&quot;timeunit = &quot; + timeunit);
        return 0;
    }

    static int run(String... args) throws Exception {
        final AnnottationAwareSetup setup = new AnnottationAwareSetup(&quot;DemoFileLister&quot;);
        setup.setDefaultSubCommand(DemoFileLister.class);
        return BasicArgsParser.process(setup, args);
    }
}
</pre></div></div>
<div class="section">
<h4>Defining option method<a name="Defining_option_method"></a></h4>
<p>Rules</p>
<ul>
<li>option method must be annottated with <tt>@Option</tt>, specifying at least one of <tt>shortName</tt> or <tt>longName</tt> attributes</li>
<li>option method must return void and cannot be static</li>
<li>option method is invoked for every occurence on the commandline</li>
<li>method param(s) map to option value(s)</li>
<li>varargs cannot be used for options (it works just as array)</li></ul>
<p>Hints</p>
<ul>
<li>when design your commandline structure, you should make options really optional - &quot;mandatory options&quot; are not nice, and <b>args-inject</b> does not provide any specific support for it</li>
<li>option can have as many values as you wish; however, using 0..2 params should usually make you happy enough</li>
<li>make the functionality independent of mutual commandline order - it makes the functionality easier to predict</li></ul></div>
<div class="section">
<h4>Creating application class<a name="Creating_application_class"></a></h4>
<p>Rules</p>
<ul>
<li>implement both <tt>main</tt> and <tt>run</tt> as shown in <b>MiniCalc sample</b></li>
<li>your application should always return with 0 on success and with 1 on failure; this is conveniently handled by method <tt>BasicArgsParser.process</tt></li></ul>
<p>Hints</p>
<ul>
<li>use default help command</li></ul>
<div class="section">
<h5>Sample main method<a name="Sample_main_method"></a></h5><pre class="brush: java">    public static void main(String[] args) throws Exception {
        final AnnottationAwareSetup setup = new AnnottationAwareSetup(&quot;myapp&quot;);
        setup.setDefaultSubCommand(DemoFileLister.class);
        final int exitCode = BasicArgsParser.process(setup, args);
        if (exitCode != 0) {
            System.exit(exitCode); // indicate failure to shell
        }
    }
</pre></div></div>
<div class="section">
<h4>Creating wrapper shell script<a name="Creating_wrapper_shell_script"></a></h4>
<p>Rules</p>
<ul>
<li>use the name you specified in <tt>main()</tt> as the base name; that is, <tt>something.bat</tt> or <tt>something.cmd</tt> on Windows, and just <tt>something</tt> on Linux</li>
<li>be sure to pass exitcode from JVM also out from the script; putting <tt>java</tt> as the latest command usually does the job</li>
<li>remember to pass script arguments to your main class - on Windows, use &quot;<tt>%*</tt>&quot;, on Linux, use &quot;<tt>$*</tt>&quot;. </li></ul>
<p>Hints</p>
<ul>
<li>remember to include all runtime dependencies in the resulting classpath</li>
<li>keep the shell script as brief as possible; long scripts are difficult to translate under certain platforms, especially Windows</li>
<li>on Linux, if your last command of the script is <tt>java</tt> <i>(recommended!)</i>, then it is good to call it with exec to reuse script's process for JVM:
<p><tt>exec java -classpath $CP net.kozelka.args.minicalc.MiniCalc $*</tt></p></li>
<li>there are several tools to ensure that your output jar does not require any external libraries, which makes the launcher a bit simpler. Have a look at:
<ul>
<li><a class="externalLink" href="http://code.google.com/p/onejar-maven-plugin">onejar-maven-plugin</a> using <a class="externalLink" href="http://one-jar.sourceforge.net">one-jar library</a> - packages dependencies into your jar; your code is then executed via a proxy main class and its custom classloader</li>
<li><a class="externalLink" href="http://maven.apache.org/plugins/maven-shade-plugin">maven-shade-plugin</a> - see <a class="externalLink" href="http://maven.apache.org/plugins/maven-shade-plugin/examples/executable-jar.html">Executable JAR</a> - dependency classes are extracted and mixed into your jar
<ul>
<li><a class="externalLink" href="http://maven.apache.org/plugins/maven-dependency-plugin/unpack-dependencies-mojo.html">unpack-dependencies mojo of maven-dependency-plugin</a> can produce similar effect but without <a class="externalLink" href="http://maven.apache.org/plugins/maven-shade-plugin/examples/resource-transformers.html">resource transformation</a></li></ul></li>
<li><a class="externalLink" href="http://maven.apache.org/plugins/maven-assembly-plugin">maven-assembly-plugin</a></li></ul></li></ul></div></div>
<div class="section">
<h3>Finetuning<a name="Finetuning"></a></h3>
<ul>
<li>using default command - see <a href="./Subcommands.html">Subcommands</a></li>
<li>specifying symbolic names to improve help outputs - see <a href="./Params.html">Params</a></li>
<li>working with arrays - see <a href="./Options.html">Options</a></li>
<li>TODO: using help as the default</li></ul></div></div>
                  </div>
          </div>

    <hr/>

    <footer>
            <div class="container">
                      <div class="row">
                              <p >Copyright &copy;                    2014
                        <a href="http://kozelka.net">Petr Kozelka</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
                <p id="poweredBy" class="pull-right">
                          <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
              </p>
        
                </div>
    </footer>
        </body>
</html>
